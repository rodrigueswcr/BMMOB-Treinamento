<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Participante - Dados Gerais</title>
  <style>
    *{box-sizing:border-box}
    html, body { height:100%; }
    body{
      margin:0;font-family:Arial,Helvetica,sans-serif;background:#f1f1f1;
      display:flex;justify-content:center;align-items:center;min-height:100dvh;
    }
    .container{
      background:#fff;width:100%;max-width:400px;height:100dvh;
      display:flex;flex-direction:column;
    }

    /* Topbar padrão */
    .topbar{
      background:#333;color:#fff;display:flex;align-items:center;justify-content:space-between;
      padding:10px 12px;font-weight:bold;flex-shrink:0;
    }
    .topbar .title{ text-transform:uppercase; letter-spacing:.5px; }
    .topbar img{ width:22px;height:22px;cursor:pointer; }

    /* Conteúdo */
    .subtitle{ text-align:center; color:#444; font-weight:bold; margin:6px 0 10px 0; }
    .content{flex:1;overflow-y:auto;padding:12px 16px 16px 16px}

    label{display:block;font-size:12px;color:#2f6f73;margin:10px 0 6px}
    .req::before{content:"* "; color:#d00; font-weight:bold}

    select, input[type="text"]{
      width:100%; padding:10px 12px; border:1px solid #ccc; border-radius:6px;
      background:#fff; font-size:14px; outline:none;
    }
    select:focus, input[type="text"]:focus{border-color:#888}

    /* Linha horizontal para o campo "Presente" (mantendo o restante do layout) */
    .line{ display:flex; align-items:center; justify-content:space-between; margin:14px 0 4px; }
    .line-label{ font-size:12px; color:#2f6f73; display:flex; align-items:center; gap:4px; }

    /* Presente - radios com o texto antes e o círculo depois (como viatura) */
    .radios{ display:flex; align-items:center; gap:20px; }
    .radios label{ display:inline-flex; align-items:center; gap:12px; font-size:14px; cursor:pointer; }
    .radios label span{ color:#9aa0a6; }
    .radios label:has(input:checked) span{ color:#222; }
    .radios input[type="radio"]{ margin:0; }

    /* Pager (bolinhas) */
    .pager-dots{display:flex;justify-content:center;align-items:center;gap:8px;padding:8px 0}
    .pager-dot{display:inline-block;width:8px;height:8px;border-radius:50%;background:#cdd2d3}
    .pager-dot.active{background:#2f6f73}
  </style>
</head>
<body>
  <div class="container">
    <!-- Topbar -->
    <div class="topbar">
      <img src="img/back.png" alt="Voltar" id="btnBack">
      <div class="title">DADOS GERAIS</div>
      <img src="img/check.png" alt="Confirmar" id="btnSave">
    </div>

    <div class="subtitle">BOLETIM DE OCORRÊNCIA</div>

    <!-- Formulário -->
    <div class="content">
      <!-- Tipo de Participação -->
      <label class="req" for="tipo">Tipo de Participação</label>
      <select id="tipo" required>
        <option value="" selected disabled>Selecione...</option>
        <option>Condutor</option>
        <option>Vítima</option>
        <option>Testemunha</option>
        <option>Autor</option>
      </select>

      <!-- Presente: agora na MESMA LINHA do rótulo -->
      <div class="line" role="radiogroup" aria-label="Presente">
        <div class="line-label"><span class="req"></span>Presente</div>
        <div class="radios">
          <label><span>Sim</span><input type="radio" name="presente" value="Sim"></label>
          <label><span>Não</span><input type="radio" name="presente" value="Não"></label>
        </div>
      </div>

      <!-- Condição Física -->
      <label for="condicao" style="margin-top:14px;">Condição Física</label>
      <select id="condicao">
        <option value="" selected disabled>Selecione...</option>
        <option>Normal</option>
        <option>Medicado</option>
        <option>Hospitalizado</option>
        <option>Morto</option>
        <option>Ferido</option>
      </select>

      <!-- Local de Atendimento -->
      <label for="local" style="margin-top:14px;">Local de Atendimento</label>
      <select id="local">
        <option value="" selected disabled>Selecione...</option>
        <option>No local</option>
        <option>UPA</option>
        <option>Hospital</option>
        <option>Posto de Saúde</option>
        <option>Outro</option>
      </select>
    </div>

    <!-- Indicador de páginas (visual) -->
    <div class="pager-dots" aria-label="Progresso">
      <span class="pager-dot active"></span>
      <span class="pager-dot"></span>
      <span class="pager-dot"></span>
      <span class="pager-dot"></span>
    </div>
  </div>

  <script>
    /* ===== Persistência mínima ===== */
    const KEY_LISTA = 'participantes_lista';

    function getLista(){ try { return JSON.parse(sessionStorage.getItem(KEY_LISTA)||'[]'); } catch { return []; } }
    function setLista(arr){ sessionStorage.setItem(KEY_LISTA, JSON.stringify(arr)); }

    function validar(){
      const tipo = document.getElementById('tipo').value;
      const presente = document.querySelector('input[name="presente"]:checked')?.value || '';

      if(!tipo){ alert('Selecione o TIPO DE PARTICIPAÇÃO.'); return false; }
      if(!presente){ alert('Informe se o participante está PRESENTE.'); return false; }
      return true;
    }

    function salvar(){
      if(!validar()) return;

      const item = {
        id: 'p_' + Date.now(),
        tipo: document.getElementById('tipo').value,
        presente: document.querySelector('input[name="presente"]:checked')?.value || '',
        condicao: document.getElementById('condicao').value || '',
        local: document.getElementById('local').value || ''
      };

      const arr = getLista();
      arr.unshift(item);
      setLista(arr);

      // Volta para a lista
      window.location.href = 'participantes.html';
    }

    document.getElementById('btnSave').addEventListener('click', salvar);
    document.getElementById('btnBack').addEventListener('click', ()=>{
      if(history.length>1) history.back(); else window.location.href='participantes.html';
    });
  </script>
</body>
</html>
