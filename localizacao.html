<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Localização - Boletim</title>

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

  <style>
    *{box-sizing:border-box}
    :root{
      --vh: 1vh;
      scrollbar-gutter: stable;
    }
    html, body { height: 100%; }
    body{
      margin:0;font-family:Arial,Helvetica,sans-serif;background:#f1f1f1;
      display:flex;justify-content:center;align-items:center;height:100vh;
      overflow:hidden;
    }
    .container{
      background:#fff;width:100%;max-width:400px;height:calc(var(--vh, 1vh) * 100);
      display:flex;flex-direction:column
    }
    @supports (height: 100dvh) {.container { height: 100dvh; }}
    .topbar{
      background:#333;color:#fff;display:flex;align-items:center;justify-content:space-between;
      padding:10px 12px;font-weight:bold;flex-shrink:0
    }
    .topbar .title{ text-transform:uppercase; letter-spacing:.5px; }
    .topbar img{ width:22px; height:22px; cursor:pointer; }
    .content{
      flex:1;overflow-y:auto;padding:4px 16px 0 16px;
      scrollbar-gutter: stable both-edges;
    }
    .card{background:transparent;border:0;padding:0;margin:0}
    .card-title{display:flex;align-items:center;justify-content:space-between;font-weight:bold;color:#333;margin:6px 0 10px}
    .geo-btn{width:68px;height:68px;border-radius:12px;border:none;background:transparent;display:flex;align-items:center;justify-content:center;cursor:pointer;padding:0}
    .geo-btn img{width:36px;height:36px}
    .row{display:flex;gap:10px}
    .col{flex:1}
    label{display:block;font-size:12px;color:#666;margin:8px 0 4px}
    .req::before{content:"* ";color:#d00;font-weight:bold}
    input,select,textarea{width:100%;padding:10px 12px;border:1px solid #d9d9d9;border-radius:6px;background:#fff;font-size:14px;outline:none}
    input:focus,select:focus,textarea:focus{border-color:#888}
    textarea{resize:vertical;min-height:70px}
    .thin{margin:8px 0;border-top:1px solid #eee}
    .pager-dots{display:flex;justify-content:center;align-items:center;gap:8px;padding:6px 0 2px 0}
    .pager-dot{display:inline-block;width:8px;height:8px;border-radius:50%;background:#cdd2d3}
    .pager-dot.active{background:#2f6f73}
    .footer{display:flex;justify-content:space-around;background-color:#2f6f73;padding:10px 0;flex-shrink:0}
    .footer img{cursor:pointer;width:28px;height:28px;transition:.2s;filter:grayscale(30%) brightness(0.9)}
    .footer img:hover{width:32px;height:32px;filter:grayscale(0%) brightness(1.2)}
    .footer img.active{filter:grayscale(0%) brightness(1.1) contrast(1.0)}
    .hint{font-size:11px;color:#666;margin-top:6px}
    .map-overlay{position:fixed;inset:0;background:#fff;display:none;z-index:9999}
    .map-topbar{background:#333;color:#fff;display:flex;align-items:center;gap:12px;padding:10px 12px;font-weight:bold}
    .map-topbar .icon{width:22px;height:22px;cursor:pointer}
    .map-title{flex:1;text-align:center}
    .map-search{padding:8px 12px;background:#f4f4f4}
    .map-search input{width:100%;padding:10px;border:1px solid #ccc;border-radius:6px;font-size:14px}
    #leafletMap{width:100%;height:calc((var(--vh, 1vh) * 100) - 96px)}
    @supports (height: 100dvh) {#leafletMap{ height:calc(100dvh - 96px); }}
  </style>
</head>
<body>
  <div class="container">
    <div class="topbar">
      <img src="img/back.png" alt="Voltar" id="btnBack">
      <div class="title">BOLETIM</div>
      <img src="img/check.png" alt="Avançar" id="btnNext">
    </div>

    <div class="content">
      <div class="card">
        <div class="card-title">
          <span>Localização</span>
          <button class="geo-btn" id="btnGeo" title="Selecionar no mapa">
            <img src="img/gps.png" alt="GPS">
          </button>
        </div>

        <!-- CIDADE (obrigatório) -->
        <label for="cidade" class="req">Cidade</label>
        <select id="cidade" name="cidade" required>
         <option value="" disabled selected>Selecione</option>
<option value="Aceguá">Aceguá</option>
<option value="Água Santa">Água Santa</option>
<option value="Agudo">Agudo</option>
<option value="Ajuricaba">Ajuricaba</option>
<option value="Alecrim">Alecrim</option>
<option value="Alegrete">Alegrete</option>
<option value="Alegria">Alegria</option>
<option value="Almirante Tamandaré do Sul">Almirante Tamandaré do Sul</option>
<option value="Alpestre">Alpestre</option>
<option value="Alto Alegre">Alto Alegre</option>
<option value="Alto Feliz">Alto Feliz</option>
<option value="Alvorada">Alvorada</option>
<option value="Amaral Ferrador">Amaral Ferrador</option>
<option value="Ametista do Sul">Ametista do Sul</option>
<option value="André da Rocha">André da Rocha</option>
<option value="Anta Gorda">Anta Gorda</option>
<option value="Antônio Prado">Antônio Prado</option>
<option value="Arambaré">Arambaré</option>
<option value="Araricá">Araricá</option>
<option value="Aratiba">Aratiba</option>
<option value="Arroio do Meio">Arroio do Meio</option>
<option value="Arroio do Padre">Arroio do Padre</option>
<option value="Arroio do Sal">Arroio do Sal</option>
<option value="Arroio do Tigre">Arroio do Tigre</option>
<option value="Arroio dos Ratos">Arroio dos Ratos</option>
<option value="Arroio Grande">Arroio Grande</option>
<option value="Arvorezinha">Arvorezinha</option>
<option value="Augusto Pestana">Augusto Pestana</option>
<option value="Áurea">Áurea</option>
<option value="Bagé">Bagé</option>
<option value="Balneário Pinhal">Balneário Pinhal</option>
<option value="Barão">Barão</option>
<option value="Barão de Cotegipe">Barão de Cotegipe</option>
<option value="Barão do Triunfo">Barão do Triunfo</option>
<option value="Barra do Guarita">Barra do Guarita</option>
<option value="Barra do Quaraí">Barra do Quaraí</option>
<option value="Barra do Ribeiro">Barra do Ribeiro</option>
<option value="Barra do Rio Azul">Barra do Rio Azul</option>
<option value="Barra Funda">Barra Funda</option>
<option value="Barracão">Barracão</option>
<option value="Barros Cassal">Barros Cassal</option>
<option value="Benjamin Constant do Sul">Benjamin Constant do Sul</option>
<option value="Bento Gonçalves">Bento Gonçalves</option>
<option value="Boa Vista das Missões">Boa Vista das Missões</option>
<option value="Boa Vista do Buricá">Boa Vista do Buricá</option>
<option value="Boa Vista do Cadeado">Boa Vista do Cadeado</option>
<option value="Boa Vista do Incra">Boa Vista do Incra</option>
<option value="Boa Vista do Sul">Boa Vista do Sul</option>
<option value="Bom Jesus">Bom Jesus</option>
<option value="Bom Princípio">Bom Princípio</option>
<option value="Bom Progresso">Bom Progresso</option>
<option value="Bom Retiro do Sul">Bom Retiro do Sul</option>
<option value="Boqueirão do Leão">Boqueirão do Leão</option>
<option value="Bossoroca">Bossoroca</option>
<option value="Bozano">Bozano</option>
<option value="Braga">Braga</option>
<option value="Brochier">Brochier</option>
<option value="Butiá">Butiá</option>
<option value="Caçapava do Sul">Caçapava do Sul</option>
<option value="Cacequi">Cacequi</option>
<option value="Cachoeira do Sul">Cachoeira do Sul</option>
<option value="Cachoeirinha">Cachoeirinha</option>
<option value="Cacique Doble">Cacique Doble</option>
<option value="Caibaté">Caibaté</option>
<option value="Caiçara">Caiçara</option>
<option value="Camaquã">Camaquã</option>
<option value="Camargo">Camargo</option>
<option value="Cambará do Sul">Cambará do Sul</option>
<option value="Campestre da Serra">Campestre da Serra</option>
<option value="Campina das Missões">Campina das Missões</option>
<option value="Campinas do Sul">Campinas do Sul</option>
<option value="Campo Bom">Campo Bom</option>
<option value="Campo Novo">Campo Novo</option>
<option value="Campos Borges">Campos Borges</option>
<option value="Candelária">Candelária</option>
<option value="Cândido Godói">Cândido Godói</option>
<option value="Candiota">Candiota</option>
<option value="Canela">Canela</option>
<option value="Canguçu">Canguçu</option>
<option value="Canoas">Canoas</option>
<option value="Capão Bonito do Sul">Capão Bonito do Sul</option>
<option value="Capão da Canoa">Capão da Canoa</option>
<option value="Capão do Cipó">Capão do Cipó</option>
<option value="Capão do Leão">Capão do Leão</option>
<option value="Capela de Santana">Capela de Santana</option>
<option value="Capitão">Capitão</option>
<option value="Capivari do Sul">Capivari do Sul</option>
<option value="Caraá">Caraá</option>
<option value="Carazinho">Carazinho</option>
<option value="Carlos Barbosa">Carlos Barbosa</option>
<option value="Carlos Gomes">Carlos Gomes</option>
<option value="Casca">Casca</option>
<option value="Caseiros">Caseiros</option>
<option value="Catuípe">Catuípe</option>
<option value="Caxias do Sul">Caxias do Sul</option>
<option value="Centenário">Centenário</option>
<option value="Cerrito">Cerrito</option>
<option value="Cerro Branco">Cerro Branco</option>
<option value="Cerro Grande">Cerro Grande</option>
<option value="Cerro Grande do Sul">Cerro Grande do Sul</option>
<option value="Cerro Largo">Cerro Largo</option>
<option value="Chapada">Chapada</option>
<option value="Charqueadas">Charqueadas</option>
<option value="Charrua">Charrua</option>
<option value="Chiapetta">Chiapetta</option>
<option value="Chuí">Chuí</option>
<option value="Chuvisca">Chuvisca</option>
<option value="Cidreira">Cidreira</option>
<option value="Ciríaco">Ciríaco</option>
<option value="Colinas">Colinas</option>
<option value="Colorado">Colorado</option>
<option value="Condor">Condor</option>
<option value="Constantina">Constantina</option>
<option value="Coqueiro Baixo">Coqueiro Baixo</option>
<option value="Coqueiros do Sul">Coqueiros do Sul</option>
<option value="Coronel Barros">Coronel Barros</option>
<option value="Coronel Bicaco">Coronel Bicaco</option>
<option value="Coronel Pilar">Coronel Pilar</option>
<option value="Cotiporã">Cotiporã</option>
<option value="Coxilha">Coxilha</option>
<option value="Crissiumal">Crissiumal</option>
<option value="Cristal">Cristal</option>
<option value="Cristal do Sul">Cristal do Sul</option>
<option value="Cruz Alta">Cruz Alta</option>
<option value="Cruzaltense">Cruzaltense</option>
<option value="Cruzeiro do Sul">Cruzeiro do Sul</option>
<option value="David Canabarro">David Canabarro</option>
<option value="Derrubadas">Derrubadas</option>
<option value="Dezesseis de Novembro">Dezesseis de Novembro</option>
<option value="Dilermando de Aguiar">Dilermando de Aguiar</option>
<option value="Dois Irmãos">Dois Irmãos</option>
<option value="Dois Irmãos das Missões">Dois Irmãos das Missões</option>
<option value="Dois Lajeados">Dois Lajeados</option>
<option value="Dom Feliciano">Dom Feliciano</option>
<option value="Dom Pedrito">Dom Pedrito</option>
<option value="Dom Pedro de Alcântara">Dom Pedro de Alcântara</option>
<option value="Dona Francisca">Dona Francisca</option>
<option value="Doutor Maurício Cardoso">Doutor Maurício Cardoso</option>
<option value="Doutor Ricardo">Doutor Ricardo</option>
<option value="Eldorado do Sul">Eldorado do Sul</option>
<option value="Encantado">Encantado</option>
<option value="Encruzilhada do Sul">Encruzilhada do Sul</option>
<option value="Engenho Velho">Engenho Velho</option>
<option value="Entre Rios do Sul">Entre Rios do Sul</option>
<option value="Entre-Ijuís">Entre-Ijuís</option>
<option value="Erebango">Erebango</option>
<option value="Erechim">Erechim</option>
<option value="Ernestina">Ernestina</option>
<option value="Erval Grande">Erval Grande</option>
<option value="Erval Seco">Erval Seco</option>
<option value="Esmeralda">Esmeralda</option>
<option value="Esperança do Sul">Esperança do Sul</option>
<option value="Espumoso">Espumoso</option>
<option value="Estação">Estação</option>
<option value="Estância Velha">Estância Velha</option>
<option value="Esteio">Esteio</option>
<option value="Estrela">Estrela</option>
<option value="Estrela Velha">Estrela Velha</option>
<option value="Eugênio de Castro">Eugênio de Castro</option>
<option value="Fagundes Varela">Fagundes Varela</option>
<option value="Farroupilha">Farroupilha</option>
<option value="Faxinal do Soturno">Faxinal do Soturno</option>
<option value="Faxinalzinho">Faxinalzinho</option>
<option value="Fazenda Vilanova">Fazenda Vilanova</option>
<option value="Feliz">Feliz</option>
<option value="Flores da Cunha">Flores da Cunha</option>
<option value="Floriano Peixoto">Floriano Peixoto</option>
<option value="Fontoura Xavier">Fontoura Xavier</option>
<option value="Formigueiro">Formigueiro</option>
<option value="Forquetinha">Forquetinha</option>
<option value="Fortaleza dos Valos">Fortaleza dos Valos</option>
<option value="Frederico Westphalen">Frederico Westphalen</option>
<option value="Garibaldi">Garibaldi</option>
<option value="Garruchos">Garruchos</option>
<option value="Gaurama">Gaurama</option>
<option value="General Câmara">General Câmara</option>
<option value="Gentil">Gentil</option>
<option value="Getúlio Vargas">Getúlio Vargas</option>
<option value="Giruá">Giruá</option>
<option value="Glorinha">Glorinha</option>
<option value="Gramado">Gramado</option>
<option value="Gramado dos Loureiros">Gramado dos Loureiros</option>
<option value="Gramado Xavier">Gramado Xavier</option>
<option value="Gravataí">Gravataí</option>
<option value="Guabiju">Guabiju</option>
<option value="Guaíba">Guaíba</option>
<option value="Guaporé">Guaporé</option>
<option value="Guarani das Missões">Guarani das Missões</option>
<option value="Harmonia">Harmonia</option>
<option value="Herval">Herval</option>
<option value="Herveiras">Herveiras</option>
<option value="Horizontina">Horizontina</option>
<option value="Hulha Negra">Hulha Negra</option>
<option value="Humaitá">Humaitá</option>
<option value="Ibarama">Ibarama</option>
<option value="Ibiaçá">Ibiaçá</option>
<option value="Ibiraiaras">Ibiraiaras</option>
<option value="Ibirapuitã">Ibirapuitã</option>
<option value="Ibirubá">Ibirubá</option>
<option value="Igrejinha">Igrejinha</option>
<option value="Ijuí">Ijuí</option>
<option value="Ilópolis">Ilópolis</option>
<option value="Imbé">Imbé</option>
<option value="Imigrante">Imigrante</option>
<option value="Independência">Independência</option>
<option value="Inhacorá">Inhacorá</option>
<option value="Ipê">Ipê</option>
<option value="Ipiranga do Sul">Ipiranga do Sul</option>
<option value="Iraí">Iraí</option>
<option value="Itaara">Itaara</option>
<option value="Itacurubi">Itacurubi</option>
<option value="Itapuca">Itapuca</option>
<option value="Itaqui">Itaqui</option>
<option value="Itati">Itati</option>
<option value="Itatiba do Sul">Itatiba do Sul</option>
<option value="Ivorá">Ivorá</option>
<option value="Ivoti">Ivoti</option>
<option value="Jaboticaba">Jaboticaba</option>
<option value="Jacuizinho">Jacuizinho</option>
<option value="Jacutinga">Jacutinga</option>
<option value="Jaguarão">Jaguarão</option>
<option value="Jaguari">Jaguari</option>
<option value="Jaquirana">Jaquirana</option>
<option value="Jari">Jari</option>
<option value="Jóia">Jóia</option>
<option value="Júlio de Castilhos">Júlio de Castilhos</option>
<option value="Lagoa Bonita do Sul">Lagoa Bonita do Sul</option>
<option value="Lagoa dos Três Cantos">Lagoa dos Três Cantos</option>
<option value="Lagoa Vermelha">Lagoa Vermelha</option>
<option value="Lagoão">Lagoão</option>
<option value="Lajeado">Lajeado</option>
<option value="Lajeado do Bugre">Lajeado do Bugre</option>
<option value="Lavras do Sul">Lavras do Sul</option>
<option value="Liberato Salzano">Liberato Salzano</option>
<option value="Lindolfo Collor">Lindolfo Collor</option>
<option value="Linha Nova">Linha Nova</option>
<option value="Maçambará">Maçambará</option>
<option value="Machadinho">Machadinho</option>
<option value="Mampituba">Mampituba</option>
<option value="Manoel Viana">Manoel Viana</option>
<option value="Maquiné">Maquiné</option>
<option value="Maratá">Maratá</option>
<option value="Marau">Marau</option>
<option value="Marcelino Ramos">Marcelino Ramos</option>
<option value="Mariana Pimentel">Mariana Pimentel</option>
<option value="Mariano Moro">Mariano Moro</option>
<option value="Marques de Souza">Marques de Souza</option>
<option value="Mata">Mata</option>
<option value="Mato Castelhano">Mato Castelhano</option>
<option value="Mato Leitão">Mato Leitão</option>
<option value="Mato Queimado">Mato Queimado</option>
<option value="Maximiliano de Almeida">Maximiliano de Almeida</option>
<option value="Minas do Leão">Minas do Leão</option>
<option value="Miraguaí">Miraguaí</option>
<option value="Montauri">Montauri</option>
<option value="Monte Alegre dos Campos">Monte Alegre dos Campos</option>
<option value="Monte Belo do Sul">Monte Belo do Sul</option>
<option value="Montenegro">Montenegro</option>
<option value="Mormaço">Mormaço</option>
<option value="Morrinhos do Sul">Morrinhos do Sul</option>
<option value="Morro Redondo">Morro Redondo</option>
<option value="Morro Reuter">Morro Reuter</option>
<option value="Mostardas">Mostardas</option>
<option value="Muçum">Muçum</option>
<option value="Muitos Capões">Muitos Capões</option>
<option value="Muliterno">Muliterno</option>
<option value="Não-Me-Toque">Não-Me-Toque</option>
<option value="Nicolau Vergueiro">Nicolau Vergueiro</option>
<option value="Nonoai">Nonoai</option>
<option value="Nova Alvorada">Nova Alvorada</option>
<option value="Nova Araçá">Nova Araçá</option>
<option value="Nova Bassano">Nova Bassano</option>
<option value="Nova Boa Vista">Nova Boa Vista</option>
<option value="Nova Bréscia">Nova Bréscia</option>
<option value="Nova Candelária">Nova Candelária</option>
<option value="Nova Esperança do Sul">Nova Esperança do Sul</option>
<option value="Nova Hartz">Nova Hartz</option>
<option value="Nova Pádua">Nova Pádua</option>
<option value="Nova Palma">Nova Palma</option>
<option value="Nova Petrópolis">Nova Petrópolis</option>
<option value="Nova Prata">Nova Prata</option>
<option value="Nova Ramada">Nova Ramada</option>
<option value="Nova Roma do Sul">Nova Roma do Sul</option>
<option value="Nova Santa Rita">Nova Santa Rita</option>
<option value="Novo Barreiro">Novo Barreiro</option>
<option value="Novo Cabrais">Novo Cabrais</option>
<option value="Novo Hamburgo">Novo Hamburgo</option>
<option value="Novo Machado">Novo Machado</option>
<option value="Novo Tiradentes">Novo Tiradentes</option>
<option value="Novo Xingu">Novo Xingu</option>
<option value="Osório">Osório</option>
<option value="Paim Filho">Paim Filho</option>
<option value="Palmares do Sul">Palmares do Sul</option>
<option value="Palmeira das Missões">Palmeira das Missões</option>
<option value="Palmitinho">Palmitinho</option>
<option value="Panambi">Panambi</option>
<option value="Pantano Grande">Pantano Grande</option>
<option value="Paraí">Paraí</option>
<option value="Paraíso do Sul">Paraíso do Sul</option>
<option value="Pareci Novo">Pareci Novo</option>
<option value="Parobé">Parobé</option>
<option value="Passa Sete">Passa Sete</option>
<option value="Passo do Sobrado">Passo do Sobrado</option>
<option value="Passo Fundo">Passo Fundo</option>
<option value="Paulo Bento">Paulo Bento</option>
<option value="Paverama">Paverama</option>
<option value="Pedras Altas">Pedras Altas</option>
<option value="Pedro Osório">Pedro Osório</option>
<option value="Pejuçara">Pejuçara</option>
<option value="Pelotas">Pelotas</option>
<option value="Picada Café">Picada Café</option>
<option value="Pinhal">Pinhal</option>
<option value="Pinhal da Serra">Pinhal da Serra</option>
<option value="Pinhal Grande">Pinhal Grande</option>
<option value="Pinheirinho do Vale">Pinheirinho do Vale</option>
<option value="Pinheiro Machado">Pinheiro Machado</option>
<option value="Pirapó">Pirapó</option>
<option value="Piratini">Piratini</option>
<option value="Planalto">Planalto</option>
<option value="Poço das Antas">Poço das Antas</option>
<option value="Pontão">Pontão</option>
<option value="Ponte Preta">Ponte Preta</option>
<option value="Portão">Portão</option>
<option value="Porto Alegre">Porto Alegre</option>
<option value="Porto Lucena">Porto Lucena</option>
<option value="Porto Mauá">Porto Mauá</option>
<option value="Porto Vera Cruz">Porto Vera Cruz</option>
<option value="Porto Xavier">Porto Xavier</option>
<option value="Pouso Novo">Pouso Novo</option>
<option value="Presidente Lucena">Presidente Lucena</option>
<option value="Progresso">Progresso</option>
<option value="Protásio Alves">Protásio Alves</option>
<option value="Putinga">Putinga</option>
<option value="Quaraí">Quaraí</option>
<option value="Quatro Irmãos">Quatro Irmãos</option>
<option value="Quevedos">Quevedos</option>
<option value="Quinze de Novembro">Quinze de Novembro</option>
<option value="Redentora">Redentora</option>
<option value="Relvado">Relvado</option>
<option value="Restinga Seca">Restinga Seca</option>
<option value="Rio dos Índios">Rio dos Índios</option>
<option value="Rio Grande">Rio Grande</option>
<option value="Rio Pardo">Rio Pardo</option>
<option value="Riozinho">Riozinho</option>
<option value="Roca Sales">Roca Sales</option>
<option value="Rodeio Bonito">Rodeio Bonito</option>
<option value="Rolador">Rolador</option>
<option value="Rolante">Rolante</option>
<option value="Ronda Alta">Ronda Alta</option>
<option value="Rondinha">Rondinha</option>
<option value="Roque Gonzales">Roque Gonzales</option>
<option value="Rosário do Sul">Rosário do Sul</option>
<option value="Sagrada Família">Sagrada Família</option>
<option value="Saldanha Marinho">Saldanha Marinho</option>
<option value="Salto do Jacuí">Salto do Jacuí</option>
<option value="Salvador das Missões">Salvador das Missões</option>
<option value="Salvador do Sul">Salvador do Sul</option>
<option value="Sananduva">Sananduva</option>
<option value="Santa Bárbara do Sul">Santa Bárbara do Sul</option>
<option value="Santa Cecília do Sul">Santa Cecília do Sul</option>
<option value="Santa Clara do Sul">Santa Clara do Sul</option>
<option value="Santa Cruz do Sul">Santa Cruz do Sul</option>
<option value="Santa Margarida do Sul">Santa Margarida do Sul</option>
<option value="Santa Maria">Santa Maria</option>
<option value="Santa Maria do Herval">Santa Maria do Herval</option>
<option value="Santa Rosa">Santa Rosa</option>
<option value="Santa Tereza">Santa Tereza</option>
<option value="Santa Vitória do Palmar">Santa Vitória do Palmar</option>
<option value="Santana da Boa Vista">Santana da Boa Vista</option>
<option value="Santana do Livramento">Santana do Livramento</option>
<option value="Santiago">Santiago</option>
<option value="Santo Ângelo">Santo Ângelo</option>
<option value="Santo Antônio da Patrulha">Santo Antônio da Patrulha</option>
<option value="Santo Antônio das Missões">Santo Antônio das Missões</option>
<option value="Santo Antônio do Palma">Santo Antônio do Palma</option>
<option value="Santo Antônio do Planalto">Santo Antônio do Planalto</option>
<option value="Santo Augusto">Santo Augusto</option>
<option value="Santo Cristo">Santo Cristo</option>
<option value="Santo Expedito do Sul">Santo Expedito do Sul</option>
<option value="São Borja">São Borja</option>
<option value="São Domingos do Sul">São Domingos do Sul</option>
<option value="São Francisco de Assis">São Francisco de Assis</option>
<option value="São Francisco de Paula">São Francisco de Paula</option>
<option value="São Gabriel">São Gabriel</option>
<option value="São Jerônimo">São Jerônimo</option>
<option value="São João da Urtiga">São João da Urtiga</option>
<option value="São João do Polêsine">São João do Polêsine</option>
<option value="São Jorge">São Jorge</option>
<option value="São José das Missões">São José das Missões</option>
<option value="São José do Herval">São José do Herval</option>
<option value="São José do Hortêncio">São José do Hortêncio</option>
<option value="São José do Inhacorá">São José do Inhacorá</option>
<option value="São José do Norte">São José do Norte</option>
<option value="São José do Ouro">São José do Ouro</option>
<option value="São José do Sul">São José do Sul</option>
<option value="São José dos Ausentes">São José dos Ausentes</option>
<option value="São Leopoldo">São Leopoldo</option>
<option value="São Lourenço do Sul">São Lourenço do Sul</option>
<option value="São Luiz Gonzaga">São Luiz Gonzaga</option>
<option value="São Marcos">São Marcos</option>
<option value="São Martinho">São Martinho</option>
<option value="São Martinho da Serra">São Martinho da Serra</option>
<option value="São Miguel das Missões">São Miguel das Missões</option>
<option value="São Nicolau">São Nicolau</option>
<option value="São Paulo das Missões">São Paulo das Missões</option>
<option value="São Pedro da Serra">São Pedro da Serra</option>
<option value="São Pedro das Missões">São Pedro das Missões</option>
<option value="São Pedro do Butiá">São Pedro do Butiá</option>
<option value="São Pedro do Sul">São Pedro do Sul</option>
<option value="São Sebastião do Caí">São Sebastião do Caí</option>
<option value="São Sepé">São Sepé</option>
<option value="São Valentim">São Valentim</option>
<option value="São Valentim do Sul">São Valentim do Sul</option>
<option value="São Valério do Sul">São Valério do Sul</option>
<option value="São Vendelino">São Vendelino</option>
<option value="São Vicente do Sul">São Vicente do Sul</option>
<option value="Sapiranga">Sapiranga</option>
<option value="Sapucaia do Sul">Sapucaia do Sul</option>
<option value="Sarandi">Sarandi</option>
<option value="Seberi">Seberi</option>
<option value="Sede Nova">Sede Nova</option>
<option value="Segredo">Segredo</option>
<option value="Selbach">Selbach</option>
<option value="Senador Salgado Filho">Senador Salgado Filho</option>
<option value="Sentinela do Sul">Sentinela do Sul</option>
<option value="Serafina Corrêa">Serafina Corrêa</option>
<option value="Sério">Sério</option>
<option value="Sertão">Sertão</option>
<option value="Sertão Santana">Sertão Santana</option>
<option value="Sete de Setembro">Sete de Setembro</option>
<option value="Severiano de Almeida">Severiano de Almeida</option>
<option value="Silveira Martins">Silveira Martins</option>
<option value="Sinimbu">Sinimbu</option>
<option value="Sobradinho">Sobradinho</option>
<option value="Soledade">Soledade</option>
<option value="Tabaí">Tabaí</option>
<option value="Tapejara">Tapejara</option>
<option value="Tapera">Tapera</option>
<option value="Tapes">Tapes</option>
<option value="Taquara">Taquara</option>
<option value="Taquari">Taquari</option>
<option value="Taquaruçu do Sul">Taquaruçu do Sul</option>
<option value="Tavares">Tavares</option>
<option value="Tenente Portela">Tenente Portela</option>
<option value="Terra de Areia">Terra de Areia</option>
<option value="Teutônia">Teutônia</option>
<option value="Tio Hugo">Tio Hugo</option>
<option value="Tiradentes do Sul">Tiradentes do Sul</option>
<option value="Toropi">Toropi</option>
<option value="Torres">Torres</option>
<option value="Tramandaí">Tramandaí</option>
<option value="Travesseiro">Travesseiro</option>
<option value="Três Arroios">Três Arroios</option>
<option value="Três Cachoeiras">Três Cachoeiras</option>
<option value="Três Coroas">Três Coroas</option>
<option value="Três de Maio">Três de Maio</option>
<option value="Três Forquilhas">Três Forquilhas</option>
<option value="Três Palmeiras">Três Palmeiras</option>
<option value="Três Passos">Três Passos</option>
<option value="Trindade do Sul">Trindade do Sul</option>
<option value="Triunfo">Triunfo</option>
<option value="Tucunduva">Tucunduva</option>
<option value="Tunas">Tunas</option>
<option value="Tupanci do Sul">Tupanci do Sul</option>
<option value="Tupanciretã">Tupanciretã</option>
<option value="Tupandi">Tupandi</option>
<option value="Tuparendi">Tuparendi</option>
<option value="Turuçu">Turuçu</option>
<option value="Ubiretama">Ubiretama</option>
<option value="União da Serra">União da Serra</option>
<option value="Unistalda">Unistalda</option>
<option value="Uruguaiana">Uruguaiana</option>
<option value="Vacaria">Vacaria</option>
<option value="Vale do Sol">Vale do Sol</option>
<option value="Vale Real">Vale Real</option>
<option value="Vale Verde">Vale Verde</option>
<option value="Vanini">Vanini</option>
<option value="Venâncio Aires">Venâncio Aires</option>
<option value="Vera Cruz">Vera Cruz</option>
<option value="Veranópolis">Veranópolis</option>
<option value="Vespasiano Corrêa">Vespasiano Corrêa</option>
<option value="Viadutos">Viadutos</option>
<option value="Viamão">Viamão</option>
<option value="Vicente Dutra">Vicente Dutra</option>
<option value="Victor Graeff">Victor Graeff</option>
<option value="Vila Flores">Vila Flores</option>
<option value="Vila Lângaro">Vila Lângaro</option>
<option value="Vila Maria">Vila Maria</option>
<option value="Vila Nova do Sul">Vila Nova do Sul</option>
<option value="Vista Alegre">Vista Alegre</option>
<option value="Vista Alegre do Prata">Vista Alegre do Prata</option>
<option value="Vista Gaúcha">Vista Gaúcha</option>
<option value="Vitória das Missões">Vitória das Missões</option>
<option value="Westfália">Westfália</option>
<option value="Xangri-lá">Xangri-lá</option>
        </select>

        <!-- LOGRADOURO (obrigatório) -->
        <label for="logradouro" class="req">Logradouro</label>
        <input id="logradouro" name="logradouro" type="text" placeholder="Rua / Avenida / Estrada" required>

        <div class="row">
          <div class="col">
            <label for="bairro">Bairro</label>
            <input id="bairro" name="bairro" type="text">
          </div>
          <div class="col" style="max-width:120px">
            <label for="numero">Nº</label>
            <input id="numero" name="numero" type="text" inputmode="numeric" pattern="[0-9]*">
          </div>
        </div>

        <div class="thin"></div>

        <div class="row">
          <div class="col">
            <label for="complemento">Complemento</label>
            <input id="complemento" name="complemento" type="text">
          </div>
          <div class="col">
            <!-- ÁREA (obrigatório) -->
            <label for="area" class="req">Área</label>
            <select id="area" name="area" required>
              <option value="" selected disabled>Selecione</option>
              <option>Urbana</option>
              <option>Suburbana</option>
              <option>Rural</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="col">
            <!-- TIPO/LOCAL (obrigatório) -->
            <label for="tipoLocal" class="req">Tipo/local</label>
            <select id="tipoLocal" name="tipoLocal" required>
              <option value="" selected disabled>Selecione</option>
              <option>Via pública</option>
              <option>Estab.diversão</option>
              <option>Residência</option>
              <option>Estab.comercial</option>
              <option>Estab.ensino</option>
              <option>Interior coletivos</option>
              <option>Hospitais/clínicas</option>
              <option>Metrô/rodoviária</option>
              <option>Outros</option>
            </select>
          </div>
          <div class="col">
            <label for="tipoEstab">Tipo estabelecimento</label>
            <!-- Começa desabilitado e VAZIO -->
            <select id="tipoEstab" name="tipoEstab" disabled></select>
          </div>
        </div>

        <label for="referencia" style="margin-top:10px;">Ponto de referência</label>
        <textarea id="referencia" name="referencia" placeholder="Descreva um ponto de referência"></textarea>

        <div id="geoHint" class="hint"></div>
      </div>
    </div>

     <!-- PAGER (5 etapas): Registrar → Fato → Questionário (ativo) → Localização → Histórico -->
    <div class="pager-dots" aria-label="Progresso">
      <a class="pager-dot" href="registrar.html" title="Etapa 1: Registrar"></a>
      <a class="pager-dot" href="fato-ba.html" title="Etapa 2: Fato"></a>
      <a class="pager-dot" href="questionario.html" title="Etapa 3: Questionário"></a>
      <a class="pager-dot active" href="localizacao.html" title="Etapa 4: Localização"></a>
      <a class="pager-dot" href="historico.html" title="Etapa 5: Histórico"></a>
    </div>

    <!-- Footer -->
    <div class="footer">
      <img src="img/doc.png" alt="Boletim" class="active">
      <img src="img/user.png" alt="Indivíduo">
      <img src="img/object.png" alt="Objeto">
      <img src="img/gun.png" alt="Arma">
      <img src="img/car.png" alt="Veículo">
      <img src="img/doc.png" alt="Outros">
    </div>
  </div>
  
<script>
(function footerRouter(){
  const footer = document.querySelector('.footer');
  if (!footer) return;
  const routes = {
    'Boletim':   'registrar.html',
    'Indivíduo': 'participantes.html',
    'Objeto':    'objetos.html',
    'Arma':      'armas.html',
    'Veículo':   'veiculos.html',
    'Outros':    'anexos.html'
  };
  footer.addEventListener('click', (ev) => {
    const img = ev.target.closest('img');
    if (!img) return;
    const alt = img.getAttribute('alt');
    const href = routes[alt];
    if (!href) return;
    footer.querySelectorAll('img').forEach(i => i.classList.remove('active'));
    img.classList.add('active');
    window.location.href = href;
  });
})();
</script>

  <!-- Overlay do Mapa -->
  <div class="map-overlay" id="mapOverlay" aria-hidden="true">
    <div class="map-topbar">
      <img class="icon" src="img/back.png" alt="Fechar" id="mapBack">
      <div class="map-title">Localização</div>
      <img class="icon" src="img/check.png" alt="Usar este ponto" id="mapConfirm">
    </div>
    <div class="map-search">
      <input id="mapSearch" type="search" placeholder="Pesquisar endereço, bairro, ponto..." autocomplete="off">
    </div>
    <div id="leafletMap"></div>
  </div>

  <script>
    function setVH(){ const vh = window.innerHeight * 0.01; document.documentElement.style.setProperty('--vh', `${vh}px`); }
    setVH(); window.addEventListener('resize', setVH);

    (function footerSelectable(){
      const icons=document.querySelectorAll('.footer img');
      icons.forEach(img=>img.addEventListener('click',()=>{ icons.forEach(i=>i.classList.remove('active')); img.classList.add('active'); }));
    })();

    /* Persistência */
    const KEYS = {
      cidade:'loc_cidade', logradouro:'loc_logradouro', bairro:'loc_bairro',
      numero:'loc_numero', complemento:'loc_complemento', area:'loc_area',
      tipoLocal:'loc_tipoLocal', tipoEstab:'loc_tipoEstab', referencia:'loc_referencia',
      lat:'loc_lat', lon:'loc_lon'
    };

    function saveForm(){
      sessionStorage.setItem(KEYS.cidade, document.getElementById('cidade').value || '');
      sessionStorage.setItem(KEYS.logradouro, document.getElementById('logradouro').value || '');
      sessionStorage.setItem(KEYS.bairro, document.getElementById('bairro').value || '');
      sessionStorage.setItem(KEYS.numero, document.getElementById('numero').value || '');
      sessionStorage.setItem(KEYS.complemento, document.getElementById('complemento').value || '');
      sessionStorage.setItem(KEYS.area, document.getElementById('area').value || '');
      sessionStorage.setItem(KEYS.tipoLocal, document.getElementById('tipoLocal').value || '');
      sessionStorage.setItem(KEYS.tipoEstab, document.getElementById('tipoEstab').value || '');
      sessionStorage.setItem(KEYS.referencia, document.getElementById('referencia').value || '');
    }

    function setSelectValueByTextOrAppend(selectEl, valueText){
      if(!valueText) return;
      const v = String(valueText);
      let found = false;
      for(const opt of selectEl.options){
        if(String(opt.value).toLowerCase() === v.toLowerCase()){
          selectEl.value = opt.value; found = true; break;
        }
      }
      if(!found){
        const opt = document.createElement('option');
        opt.value = v; opt.textContent = v;
        selectEl.appendChild(opt);
        selectEl.value = v;
      }
    }

    function restoreForm(){
      const cidadeSaved = sessionStorage.getItem(KEYS.cidade);
      if(cidadeSaved){ setSelectValueByTextOrAppend(document.getElementById('cidade'), cidadeSaved); }
      [['logradouro',KEYS.logradouro],['bairro',KEYS.bairro],['numero',KEYS.numero],['complemento',KEYS.complemento],['referencia',KEYS.referencia]]
      .forEach(([id,key])=>{ const v=sessionStorage.getItem(key); if(v!==null) document.getElementById(id).value=v; });
      const areaSaved = sessionStorage.getItem(KEYS.area);
      if(areaSaved){ setSelectValueByTextOrAppend(document.getElementById('area'), areaSaved); }
      const tLocalSaved = sessionStorage.getItem(KEYS.tipoLocal);
      if(tLocalSaved){ setSelectValueByTextOrAppend(document.getElementById('tipoLocal'), tLocalSaved); }
      // tipoEstab será restaurado pelo módulo de dependência quando habilitar
    }

    // ===== Dependência: Tipo/local -> Tipo estabelecimento =====
    (function dependentSelects(){
      const tipoLocal = document.getElementById('tipoLocal');
      const tipoEstab = document.getElementById('tipoEstab');

      const optionsEnsino = [
        "Bancos e similares",
        "Joalherias",
        "Postos gasolina/garagem",
        "Supermercados",
        "Bares/restaurantes",
        "Farmácias/drogarias",
        "Hotéis e similares",
        "Lojas/outros"
      ];

      function fillOptions(selectEl, items){
        selectEl.innerHTML = "";
        items.forEach(txt=>{
          const opt=document.createElement('option');
          opt.value = txt; opt.textContent = txt;
          selectEl.appendChild(opt);
        });
      }

      function clearAndDisable(){
        tipoEstab.innerHTML = "";     // caixa vazia
        tipoEstab.disabled = true;    // desabilitado
        sessionStorage.setItem(KEYS.tipoEstab, ""); // limpa valor salvo
      }

      function enableWithOptions(){
        tipoEstab.disabled = false;
        fillOptions(tipoEstab, optionsEnsino);
        // Restaura seleção se houver
        const saved = sessionStorage.getItem(KEYS.tipoEstab) || "";
        if (saved) setSelectValueByTextOrAppend(tipoEstab, saved);
      }

      function sync(){
        if (tipoLocal.value === "Estab.ensino") {
          enableWithOptions();
        } else {
          clearAndDisable();
        }
      }

      // Inicializa conforme estado atual/restaurado
      sync();

      // Observa mudanças
      tipoLocal.addEventListener('change', ()=>{ sync(); saveForm(); });
    })();

    // Navegação topbar
    document.getElementById('btnBack').addEventListener('click', ()=>{ saveForm(); window.location.href = 'fato-ba.html'; });
    document.getElementById('btnNext').addEventListener('click', ()=>{
      const cidade = document.getElementById('cidade');
      const logradouro = document.getElementById('logradouro');
      const area = document.getElementById('area');
      const tipoLocal = document.getElementById('tipoLocal');
      if (!cidade.value) { alert('Selecione a CIDADE.'); cidade.focus(); return; }
      if (!logradouro.value.trim()) { alert('Preencha o LOGRADOURO.'); logradouro.focus(); return; }
      if (!area.value) { alert('Selecione a ÁREA.'); area.focus(); return; }
      if (!tipoLocal.value) { alert('Selecione o TIPO/LOCAL.'); tipoLocal.focus(); return; }
      saveForm();
      window.location.href = 'historico.html';
    });

    // Salvar ao alterar campos
    ['cidade','logradouro','bairro','numero','complemento','area','tipoLocal','tipoEstab','referencia']
      .forEach(id=>{
        const el = document.getElementById(id);
        const evt = el.tagName === 'SELECT' ? 'change' : 'input';
        el.addEventListener(evt, saveForm);
      });

    // Apenas números no Nº
    document.getElementById('numero').addEventListener('input', (e)=>{
      e.target.value = e.target.value.replace(/\D+/g,'').slice(0,6); saveForm();
    });

    /* Mapa (Leaflet) */
    const btn = document.getElementById('btnGeo');
    const hint = document.getElementById('geoHint');
    function setHint(msg){ hint.textContent = msg; }

    async function reverseGeocode(lat, lon){
      const url = `https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${lat}&lon=${lon}&addressdetails=1`;
      const res = await fetch(url, { headers: { "Accept": "application/json", "User-Agent": "BM-Boletim/1.0 (contato-exemplo@exemplo.br)" } });
      if(!res.ok) throw new Error("Falha no serviço de geocodificação");
      return res.json();
    }
    function fillFieldsFromAddress(address){
      const street = address.road || address.pedestrian || address.footway || address.cycleway || address.path || address.neighbourhood || "";
      document.getElementById('logradouro').value = street;
      if(address.house_number){
        document.getElementById('numero').value = address.house_number.replace(/\D+/g,'').slice(0,6);
      }
      const bairro = address.suburb || address.neighbourhood || address.city_district || address.quarter || "";
      document.getElementById('bairro').value = bairro;
      const cidade = address.city || address.town || address.village || address.municipality || address.county || "";
      setSelectValueByTextOrAppend(document.getElementById('cidade'), cidade);
      saveForm();
    }

    const cityCenters = {
      "Santa Maria": [-29.6868,-53.8149],
      "Porto Alegre": [-30.0346,-51.2177],
      "Caxias do Sul": [-29.1634,-51.1794],
      "Pelotas": [-31.7654,-52.3371]
    };
    let map, marker, overlayOpen = false;

    function openMap(lat, lon, zoom=16){
      const overlay = document.getElementById('mapOverlay');
      overlay.style.display = 'block';
      overlay.setAttribute('aria-hidden','false');
      overlayOpen = true;

      if(!map){
        map = L.map('leafletMap');
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19, attribution: '&copy; OpenStreetMap contributors' }).addTo(map);
        marker = L.marker([lat, lon], {draggable:true}).addTo(map);
        map.on('click', (e)=>{ marker.setLatLng(e.latlng); });
      }else{ marker.setLatLng([lat, lon]); }
      map.setView([lat, lon], zoom);
      setTimeout(()=> map.invalidateSize(), 50);
    }
    function closeMap(){
      const overlay = document.getElementById('mapOverlay');
      overlay.style.display = 'none';
      overlay.setAttribute('aria-hidden','true');
      overlayOpen = false;
    }

    // Abrir mapa
    btn.addEventListener('click', async ()=>{
      setHint("");
      let lat=-15.78, lon=-47.93, zoom=4;
      const cidadeSel = document.getElementById('cidade').value;
      if (cityCenters[cidadeSel]){ [lat,lon]=cityCenters[cidadeSel]; zoom=13; }

      if('geolocation' in navigator){
        try{
          const pos = await new Promise((resolve, reject)=>{
            navigator.geolocation.getCurrentPosition(resolve, reject, { enableHighAccuracy:true, timeout: 8000, maximumAge: 0 });
          });
          lat = pos.coords.latitude; lon = pos.coords.longitude; zoom = 17;
        }catch(e){}
      }
      openMap(lat, lon, zoom);
    });

    // Fechar/confirmar mapa
    document.getElementById('mapBack').addEventListener('click', closeMap);
    document.getElementById('mapConfirm').addEventListener('click', async ()=>{
      if(!marker) return;
      const {lat, lng} = marker.getLatLng();
      try{
        setHint("Buscando endereço selecionado…");
        const data = await reverseGeocode(lat, lng);
        if(data && data.address){
          fillFieldsFromAddress(data.address);
          sessionStorage.setItem(KEYS.lat, String(lat));
          sessionStorage.setItem(KEYS.lon, String(lng));
          setHint("Endereço definido pelo mapa.");
        }else{ setHint("Não foi possível obter o endereço. Ajuste manualmente."); }
      }catch(err){ setHint("Erro ao converter ponto em endereço."); }
      closeMap();
    });

    // Busca no mapa (Enter)
    async function geocode(q){
      const url = `https://nominatim.openstreetmap.org/search?format=jsonv2&q=${encodeURIComponent(q)}&addressdetails=1&limit=1`;
      const res = await fetch(url, { headers: { "Accept":"application/json", "User-Agent":"BM-Boletim/1.0 (contato-exemplo@exemplo.br)" } });
      if(!res.ok) return null;
      const arr = await res.json();
      return Array.isArray(arr) && arr[0] ? arr[0] : null;
    }
    const mapSearch = document.getElementById('mapSearch');
    mapSearch.addEventListener('keydown', async (e)=>{
      if(e.key !== 'Enter') return;
      e.preventDefault();
      const q = mapSearch.value.trim(); if(!q) return;
      const r = await geocode(q);
      if(r){
        const lat = parseFloat(r.lat), lon = parseFloat(r.lon);
        map.setView([lat,lon], 17);
        marker.setLatLng([lat,lon]);
      }else{
        alert('Endereço não encontrado.');
      }
    });

    // Restaura
    restoreForm();

    // Salvar antes de navegar pelas bolinhas do pager
    document.querySelectorAll('.pager-dots a').forEach(a=>{
      a.addEventListener('click', (e)=>{
        e.preventDefault();
        saveForm();
        window.location.href = a.getAttribute('href');
      });
    });

    // ESC fecha overlay
    document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape' && overlayOpen) closeMap(); });
  </script>

  <!-- SWIPE LATERAL -->
  <script>
  (function enableSwipePages(){
    const ROUTE = ['registrar.html','fato-ba.html','questionario.html','localizacao.html','historico.html'];
    const here = (location.pathname.split('/').pop() || 'localizacao.html').toLowerCase();
    const idx = ROUTE.indexOf(here);

    let x0=null, y0=null, t0=0;
    const THRESH = 50, MAX_TIME = 600, V_SLOPE = 0.5;
    const unify = (e)=> e.changedTouches ? e.changedTouches[0] : e;

    function onStart(e){ const p=unify(e); x0=p.clientX; y0=p.clientY; t0=Date.now(); }
    function onEnd(e){
      if(x0===null) return;
      const p=unify(e), dx=p.clientX-x0, dy=p.clientY-y0, dt=Date.now()-t0;
      const horizontal = Math.abs(dx)>THRESH && Math.abs(dy)<Math.abs(dx)*V_SLOPE && dt<MAX_TIME;
      if(horizontal){
        if(dx<0 && idx<ROUTE.length-1){
          saveForm();
          location.href=ROUTE[idx+1];
        } else if(dx>0 && idx>0){
          saveForm();
          location.href=ROUTE[idx-1];
        }
      }
      x0=null;
    }

    window.addEventListener('touchstart', onStart, {passive:true});
    window.addEventListener('touchend', onEnd, {passive:true});
  })();
  </script>
</body>
</html>
